/*
----------------------------------------------------------------------------------------
    Cut and Tag Nextflow config file
----------------------------------------------------------------------------------------
*/

nextflow.enable.dsl = 2

process {
    //LSF (Platform Load Sharing Facility) 
    executor = 'lsf'
    queue    = 'short'
    memory   = '24G'
    cpus     = '4'

    errorStrategy = { task.exitStatus in ((130..145) + 104) ? 'retry' : 'finish' }
    maxRetries    = 1
    maxErrors     = '-1'

    withLabel:process_single  {
        queue    = 'short'
        memory   = '16G'
        cpus     = '1'
    }

    withLabel:process_low  {
        queue    = 'short'
        memory   = '16G'
        cpus     = '2'
    }

    withLabel:process_medium  {
        queue    = 'short'
        memory   = '32G'
        cpus     = '6'
    }

    withLabel:process_high  {
        queue    = 'long'
        memory   = '4G'
        cpus     = '16'
        time     = '2h'
    }

    withLabel:error_retry  {
        errorStrategy = 'retry'
        maxRetries   = 2
    }
}

docker.runOptions = '-u $(id -u):$(id -g)'
singularity.enabled = true


params {
    // Base Configuration
    data_dir    = "${launchDir}/data"
    results_dir = "${launchDir}/results"

    fastq_paired = null

    run_fastqc                 = false
    run_trimmomatic            = false
    run_bowtie2                = false
    run_picard                 = false
    run_mapq                   = false
    run_ucsc_file              = false

    // MultiQC
    multiqc_report_nm = "multiqc_report.html"
    
    // Trimmomatic 
    trimmomatic_control      = '"ILLUMINACLIP:./adapters/NexteraPE-PE.fa:2:25:7:1:true TRAILING:3 SLIDINGWINDOW:4:10 TRAILING:3 MINLEN:10"'

    // BowTie2 Index Path
    bowtie2_reference = "/share/GHPCC/data/umw_biocore/genome_data/c_elegans/ce11_ws245/ce11_ws245"

    aligned_sam = "${launchDir}/results/alignment/*_bowtie2.sam"

    aligned_bam = "${launchDir}/results/alignment/*_dedup.bam"

    ucsc_file_input_sam = "${launchDir}/results/alignment/*_dedup_mapq.sam"
}
